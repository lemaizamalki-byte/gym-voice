<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Gym Voice</title>

<style>
* {
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
}

body {
  margin: 0;
  height: 100vh;
  background: radial-gradient(circle at center, #0f172a, #020617);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  font-family: system-ui, -apple-system;
  color: white;
  touch-action: manipulation;
}

#mic {
  width: 190px;
  height: 190px;
  border-radius: 50%;
  background: #22c55e;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 0 40px rgba(34,197,94,.6);
}

#mic.recording {
  background: #ef4444;
  box-shadow: 0 0 50px rgba(239,68,68,.7);
}

#mic img {
  width: 120px;
  pointer-events: none;
}

#status {
  margin-top: 22px;
  font-size: 16px;
  opacity: .9;
}

#log {
  position: fixed;
  bottom: 0;
  width: 100%;
  background: rgba(2,6,23,.85);
  padding: 10px;
  font-size: 13px;
  text-align: center;
}
</style>
</head>

<body>

<div id="mic">
  <img src="avatar.png" alt="Atleta">
</div>

<div id="status">Mant√©n pulsado para grabar</div>

<div id="log"></div>

<script>
let mediaRecorder;
let audioChunks = [];
let isRecording = false;

const mic = document.getElementById("mic");
const status = document.getElementById("status");
const logBox = document.getElementById("log");

function saveEntry(blob) {
  const entries = JSON.parse(localStorage.getItem("gymAudio")) || [];
  entries.push({
    date: new Date().toLocaleString(),
    audio: URL.createObjectURL(blob)
  });
  localStorage.setItem("gymAudio", JSON.stringify(entries));
  logBox.textContent = "üéß Audio guardado (" + entries[entries.length - 1].date + ")";
}

async function startRecording() {
  try {
    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    mediaRecorder = new MediaRecorder(stream);
    audioChunks = [];

    mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
    mediaRecorder.onstop = () => {
      const blob = new Blob(audioChunks, { type: "audio/webm" });
      saveEntry(blob);
    };

    mediaRecorder.start();
    isRecording = true;
    mic.classList.add("recording");
    status.textContent = "üéôÔ∏è Grabando...";
  } catch {
    status.textContent = "‚ùå Micr√≥fono no disponible";
  }
}

function stopRecording() {
  if (!isRecording) return;
  mediaRecorder.stop();
  isRecording = false;
  mic.classList.remove("recording");
  status.textContent = "‚úÖ Grabaci√≥n guardada";
}

mic.addEventListener("touchstart", e => {
  e.preventDefault();
  startRecording();
});

mic.addEventListener("touchend", e => {
  e.preventDefault();
  stopRecording();
});

mic.addEventListener("mousedown", startRecording);
mic.addEventListener("mouseup", stopRecording);
</script>

</body>
</html>
