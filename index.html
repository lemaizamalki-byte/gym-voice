<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gym Voice</title>

<style>
* {
  -webkit-user-select: none;
  -webkit-touch-callout: none;
  user-select: none;
}

body {
  margin: 0;
  height: 100vh;
  background: #0b132b;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-family: system-ui;
  color: white;
}

#mic {
  width: 180px;
  height: 180px;
  border-radius: 50%;
  background: #22c55e;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 72px;

  touch-action: none;
  user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}

#mic.recording {
  background: #ef4444;
}

#status {
  margin-top: 20px;
  font-size: 16px;
  opacity: 0.9;
}

#audios {
  position: fixed;
  bottom: 0;
  width: 100%;
  max-height: 35%;
  overflow-y: auto;
  background: rgba(0,0,0,0.3);
  padding: 10px;
  box-sizing: border-box;
  font-size: 14px;
}

.audio-item {
  margin-bottom: 10px;
}
</style>
</head>

<body>

<div id="mic" draggable="false">üèãÔ∏è</div>
<div id="status">Mant√©n pulsado para grabar</div>

<div id="audios"></div>

<script>
let recorder;
let stream;
let chunks = [];

const mic = document.getElementById("mic");
const status = document.getElementById("status");
const audios = document.getElementById("audios");

function addAudio(blob) {
  const url = URL.createObjectURL(blob);
  const div = document.createElement("div");
  div.className = "audio-item";
  div.innerHTML = `
    üóì ${new Date().toLocaleString()}<br>
    <audio controls src="${url}"></audio>
  `;
  audios.prepend(div);
}

mic.addEventListener("touchstart", async (e) => {
  e.preventDefault();

  try {
    stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    recorder = new MediaRecorder(stream);
    chunks = [];

    recorder.ondataavailable = e => chunks.push(e.data);
    recorder.onstop = () => {
      const blob = new Blob(chunks, { type: "audio/webm" });
      addAudio(blob);
      status.textContent = "‚úÖ Audio guardado";
      stream.getTracks().forEach(t => t.stop());
    };

    recorder.start();
    mic.classList.add("recording");
    status.textContent = "üéôÔ∏è Grabando‚Ä¶ suelta para guardar";

  } catch (err) {
    status.textContent = "‚ùå No se pudo acceder al micr√≥fono";
  }
}, { passive: false });

mic.addEventListener("touchend", (e) => {
  e.preventDefault();
  if (recorder && recorder.state === "recording") {
    recorder.stop();
    mic.classList.remove("recording");
    status.textContent = "‚è≥ Guardando‚Ä¶";
  }
}, { passive: false });
</script>

</body>
</html>
